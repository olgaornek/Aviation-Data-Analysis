### FOR KPIs and ROUTE PERFORMANCE ANALYSIS ###

df = pd.read_csv(
    '/Workspace/Users/n01719419@humber.ca/ss.csv', 
    infer_datetime_format=True)

df['flight_date'] = pd.to_datetime(df['flight_date']).dt.date
df['departure_scheduled'] = pd.to_datetime(df['departure_scheduled'])
df['arrival_scheduled'] = pd.to_datetime(df['arrival_scheduled'])
df['departure_actual'] = pd.to_datetime(df['departure_actual'])
df['arrival_actual'] = pd.to_datetime(df['arrival_actual'])

df_spark = spark.createDataFrame(df)
df_spark.createOrReplaceTempView("temp_view_ss")

display(df)


##########################
### FOR FLEET ANALYSIS ###

#changing the type of columns 'date_founded' to datetime, 'fleet_average_ager' to numeric, 'fleet_size' to float.
#creating visualization 'Fleet_average_age by Country' and 'Fleet_size by Country'
df['date_founded'] = pd.to_datetime(df['date_founded'], errors='coerce')
df['fleet_average_age'] = pd.to_numeric(df['fleet_average_age'], errors='coerce')
df['fleet_size'] = df['fleet_size'].astype('float64')

df_spark = spark.createDataFrame(df)
df_spark.createOrReplaceTempView("airlines_data")

display(df)
